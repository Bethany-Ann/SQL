Climate Conference Project
Database: https://www.db-fiddle.com/f/pxMci1sLL945KHKYvpe9W6/1


-- Show which VIPS are staying in which hotels, only include VIPS who are staying in hotels. 

SELECT last_name, first_name, hotel_name
FROM vips
LEFT JOIN reservations
ON vips.member_id=reservations.member_id
LEFT JOIN hotels
ON reservations.hotel=hotels.hotel_id
WHERE hotel_id>=1
ORDER BY hotel_name;

-- Show which events each VIP is participating in, only if they are participating in an event -- 

SELECT last_name, first_name, event_name
FROM vips
LEFT JOIN events
ON vips.event=events.event_id
ORDER BY event_name;

-- Show the hotel name and address for each VIP who is staying in a hotel 

SELECT last_name, first_name, hotel_name, address
FROM vips
INNER JOIN reservations
ON vips.member_id=reservations.member_id
INNER JOIN hotels
ON reservations.hotel=hotels.hotel_id
ORDER BY last_name;


-- Show the name and hotel name of each VIP, only for VIPs from the US Department of Renewable Energy

SELECT last_name, first_name, hotel_name
FROM vips
LEFT JOIN reservations
ON vips.member_id=reservations.member_id
LEFT JOIN hotels
ON reservations.hotel=hotels.hotel_id
WHERE vips.association = (SELECT vips.association FROM vips WHERE association LIKE '%US Department of Renewable Energy%');

-- Show which VIPs are providing feedback to whom

SELECT m.member_id AS feedback_giver_id,
    m.last_name AS giver_lastname,
    f.member_id AS feedback_receiver_id,
    f.last_name AS receiver_last_name
FROM vips AS m
JOIN vips AS f
    ON f.provides_feedback_to = m.member_id


--Get a list of all education-affiliated VIPs who have registered for an event.
SELECT v.first_name, v.last_name, v.association
FROM vips v
JOIN events e ON v.event = e.event_id
WHERE v.assoc_type = 'education' AND e.event_id>=1; 


-- Get a list of all VIPs who have RSVP'd for both the welcome event and dinner

SELECT vips.member_id, vips.last_name, vips.first_name 
FROM vips
JOIN reservations
ON vips.member_id=reservations.member_id
WHERE reservations.welcome_rsvp=1
AND reservations.dinner_rsvp=1;



